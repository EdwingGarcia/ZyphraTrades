<Window x:Class="ZyphraTrades.Presentation.TradeDetailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:ZyphraTrades.Presentation.Converters"
        Title="Detalle del Trade"
        Width="800" Height="750"
        WindowStartupLocation="CenterOwner"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        ShowInTaskbar="False">

    <Window.Resources>
        <conv:PnlToBrushConverter         x:Key="PnlBrush"/>
        <conv:SideToBrushConverter        x:Key="SideBrush"/>
        <conv:RatingToStarsConverter      x:Key="Stars"/>
        <conv:EnumToSpanishConverter      x:Key="EnumEs"/>
        <conv:BoolToVisibilityConverter   x:Key="BoolVis"/>
        <conv:InverseBoolToVisibilityConverter x:Key="BoolVisInv"/>
        <conv:NullToVisibilityConverter   x:Key="NullVis"/>
        <conv:UrlToImageConverter         x:Key="UrlImg"/>

        <Style x:Key="SecLbl" TargetType="TextBlock">
            <Setter Property="FontSize" Value="9"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeMutedB}"/>
            <Setter Property="Margin" Value="0,0,0,3"/>
        </Style>
        <Style x:Key="SecTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeCyanB}"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
    </Window.Resources>

    <Border Background="{DynamicResource ThemeBg0B}"
            BorderBrush="{DynamicResource ThemeStrokeB}"
            BorderThickness="1"
            CornerRadius="14"
            Margin="10">
        <Border.Effect>
            <DropShadowEffect BlurRadius="24" Opacity="0.55" ShadowDepth="6" Color="Black"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- ═══ TITLE BAR ═══ -->
            <Border Grid.Row="0"
                    Background="{DynamicResource ThemeBg1B}"
                    CornerRadius="14,14,0,0"
                    Padding="22,14"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="{Binding Symbol}"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource ThemeCyanB}"/>
                        <Border CornerRadius="5"
                                Background="{Binding Side, Converter={StaticResource SideBrush}}"
                                Padding="10,3"
                                Margin="14,0,0,0"
                                VerticalAlignment="Center"
                                Opacity="0.85">
                            <TextBlock Text="{Binding Side, Converter={StaticResource EnumEs}}"
                                       FontSize="10"
                                       FontWeight="Bold"
                                       Foreground="White"/>
                        </Border>
                        <Border CornerRadius="5"
                                Background="{DynamicResource ThemeBg2B}"
                                Padding="10,3"
                                Margin="6,0,0,0"
                                VerticalAlignment="Center">
                            <TextBlock Text="{Binding Status, Converter={StaticResource EnumEs}}"
                                       FontSize="10"
                                       FontWeight="Bold"
                                       Foreground="{DynamicResource ThemeFgSecondaryB}"/>
                        </Border>
                    </StackPanel>
                    <Button HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Click="Close_Click"
                            Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="Bd" Background="Transparent" CornerRadius="6" Padding="10,4">
                                    <TextBlock Text="&#x2715;" FontSize="14" Foreground="{DynamicResource ThemeMutedB}"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#33FFFFFF"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Grid>
            </Border>

            <!-- ═══ CONTENT ═══ -->
            <ScrollViewer Grid.Row="1"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled">
                <StackPanel Margin="24,18,24,24">

                    <!-- ── RESULTADO PRINCIPAL ── -->
                    <Border Background="{DynamicResource ThemeBg1B}"
                            CornerRadius="10"
                            Padding="20,16"
                            Margin="0,0,0,14"
                            BorderBrush="{DynamicResource ThemeCyanB}"
                            BorderThickness="1,0,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="{Binding NetPnl, StringFormat=${}{0:N2}}"
                                       FontSize="30"
                                       FontWeight="Bold"
                                       Foreground="{Binding NetPnl, Converter={StaticResource PnlBrush}}"
                                       VerticalAlignment="Center"/>
                            <StackPanel Grid.Column="1" Orientation="Horizontal"
                                        HorizontalAlignment="Right" VerticalAlignment="Center">
                                <StackPanel Margin="0,0,24,0">
                                    <TextBlock Text="RESULTADO R" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding ResultR, StringFormat={}{0:0.00}R, TargetNullValue=--}"
                                               FontWeight="Bold" FontSize="15"
                                               Foreground="{Binding ResultR, Converter={StaticResource PnlBrush}}"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,24,0">
                                    <TextBlock Text="R:R RATIO" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding RiskRewardRatio, StringFormat=1:{0:0.0}, TargetNullValue=--}"
                                               FontWeight="Bold" FontSize="15"/>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock Text="RIESGO $" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding RiskAmount, StringFormat=${}{0:N2}, TargetNullValue=--}"
                                               FontWeight="Bold" FontSize="15"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- ── INFO + CONTEXTO (2 columnas) ── -->
                    <Grid Margin="0,0,0,14">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="14"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Izquierda: Fechas + Precios + Balance -->
                        <Border Background="{DynamicResource ThemeBg1B}"
                                CornerRadius="10" Padding="18,14">
                            <StackPanel>
                                <TextBlock Text="INFORMACIÓN" Style="{StaticResource SecTitle}"/>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="APERTURA" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding OpenedAt, StringFormat=yyyy-MM-dd HH:mm}"
                                                   FontWeight="SemiBold" FontSize="11"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="CIERRE" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding ClosedAt, StringFormat=yyyy-MM-dd HH:mm, TargetNullValue=--}"
                                                   FontWeight="SemiBold" FontSize="11"/>
                                    </StackPanel>
                                </Grid>
                                <Border Height="1" Background="{DynamicResource ThemeStrokeB}"
                                        Margin="0,2,0,10" Opacity="0.3"/>
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="ENTRADA" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding EntryPrice}" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="SALIDA" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding ExitPrice, TargetNullValue=--}" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </Grid>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="STOP LOSS" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding StopLoss, TargetNullValue=--}" FontWeight="SemiBold"
                                                   Foreground="{DynamicResource ThemeLossTextB}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="TAKE PROFIT" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding TakeProfit, TargetNullValue=--}" FontWeight="SemiBold"
                                                   Foreground="{DynamicResource ThemeWinTextB}"/>
                                    </StackPanel>
                                </Grid>
                                <Border Height="1" Background="{DynamicResource ThemeStrokeB}"
                                        Margin="0,2,0,10" Opacity="0.3"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="BALANCE ANTES" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding AccountBalanceBefore, StringFormat=${}{0:N2}, TargetNullValue=--}"
                                                   FontSize="11"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="BALANCE DESPUÉS" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding AccountBalanceAfter, StringFormat=${}{0:N2}, TargetNullValue=--}"
                                                   FontSize="11"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Derecha: Contexto + Psicología -->
                        <Border Grid.Column="2"
                                Background="{DynamicResource ThemeBg1B}"
                                CornerRadius="10" Padding="18,14">
                            <StackPanel>
                                <TextBlock Text="CONTEXTO" Style="{StaticResource SecTitle}"/>
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="TEMPORALIDAD" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding Timeframe, TargetNullValue=--}" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="SESIÓN" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding Session, Converter={StaticResource EnumEs}, TargetNullValue=--}"
                                                   FontWeight="SemiBold"/>
                                    </StackPanel>
                                </Grid>
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="SETUP" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding Setup, TargetNullValue=--}" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="ESTRATEGIA" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding Strategy, TargetNullValue=--}" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </Grid>
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="MERCADO" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding MarketCondition, Converter={StaticResource EnumEs}, TargetNullValue=--}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="CONFLUENCIA" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding Confluence, Converter={StaticResource EnumEs}, TargetNullValue=--}"/>
                                    </StackPanel>
                                </Grid>
                                <Border Height="1" Background="{DynamicResource ThemeStrokeB}"
                                        Margin="0,8,0,10" Opacity="0.3"/>
                                <TextBlock Text="PSICOLOGÍA" Style="{StaticResource SecTitle}"/>
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="EMOCIÓN ANTES" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding EmotionBefore, Converter={StaticResource EnumEs}, TargetNullValue=--}"
                                                   FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="EMOCIÓN DESPUÉS" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding EmotionAfter, Converter={StaticResource EnumEs}, TargetNullValue=--}"
                                                   FontWeight="SemiBold"/>
                                    </StackPanel>
                                </Grid>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="CONFIANZA" Style="{StaticResource SecLbl}"/>
                                        <TextBlock FontWeight="SemiBold">
                                            <Run Text="{Binding ConfidenceLevel, Mode=OneWay, TargetNullValue=--}"/>
                                            <Run Text=" / 10" Foreground="{DynamicResource ThemeMutedB}"/>
                                        </TextBlock>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="RATING" Style="{StaticResource SecLbl}"/>
                                        <TextBlock Text="{Binding Rating, Converter={StaticResource Stars}}"
                                                   FontSize="15" Foreground="{DynamicResource ThemeAmberB}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- ── CHECKLIST + PARCIALES ── -->
                    <Grid Margin="0,0,0,14">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="14"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Background="{DynamicResource ThemeBg1B}"
                                CornerRadius="10" Padding="18,14">
                            <StackPanel>
                                <TextBlock Text="CHECKLIST" Style="{StaticResource SecTitle}"/>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="CUMPLIMIENTO" Style="{StaticResource SecLbl}"/>
                                        <TextBlock FontWeight="Bold" FontSize="16"
                                                   Foreground="{DynamicResource ThemeCyanB}">
                                            <Run Text="{Binding ChecklistCompliancePercent, StringFormat={}{0:0.0}%, Mode=OneWay}"/>
                                        </TextBlock>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="PUNTUACIÓN" Style="{StaticResource SecLbl}"/>
                                        <TextBlock FontWeight="Bold" FontSize="16">
                                            <Run Text="{Binding ChecklistScore, Mode=OneWay, TargetNullValue=0}"/>
                                            <Run Text=" / " Foreground="{DynamicResource ThemeMutedB}"/>
                                            <Run Text="{Binding ChecklistTotal, Mode=OneWay, TargetNullValue=0}"/>
                                        </TextBlock>
                                    </StackPanel>
                                </Grid>
                                <ItemsControl ItemsSource="{Binding ChecklistEntries}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                                <TextBlock Text="&#x2713;" FontSize="10" Margin="0,0,6,0"
                                                           Foreground="{DynamicResource ThemeWinTextB}"
                                                           Visibility="{Binding IsChecked, Converter={StaticResource BoolVis}}"/>
                                                <TextBlock Text="&#x2717;" FontSize="10" Margin="0,0,6,0"
                                                           Foreground="{DynamicResource ThemeLossTextB}"
                                                           Visibility="{Binding IsChecked, Converter={StaticResource BoolVisInv}}"/>
                                                <TextBlock Text="{Binding ChecklistRule.Name}"
                                                           FontSize="10" Foreground="{DynamicResource ThemeMutedB}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="2"
                                Background="{DynamicResource ThemeBg1B}"
                                CornerRadius="10" Padding="18,14">
                            <StackPanel>
                                <TextBlock Text="PARCIALES" Style="{StaticResource SecTitle}"/>
                                <ItemsControl ItemsSource="{Binding Partials}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="6"
                                                    Background="{DynamicResource ThemeBg0B}"
                                                    Padding="10,7" Margin="0,2">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock FontSize="11"
                                                               Foreground="{DynamicResource ThemeCyanB}"
                                                               FontWeight="Bold">
                                                        <Run Text="{Binding PercentClosed, StringFormat={}{0:0}%, Mode=OneWay}"/>
                                                    </TextBlock>
                                                    <TextBlock Grid.Column="1" FontSize="10" Margin="10,0"
                                                               Foreground="{DynamicResource ThemeMutedB}">
                                                        <Run Text="@ "/><Run Text="{Binding ExitPrice, Mode=OneWay}"/>
                                                    </TextBlock>
                                                    <TextBlock Grid.Column="2" FontSize="10" FontWeight="SemiBold"
                                                               Foreground="{Binding RealizedPnl, Converter={StaticResource PnlBrush}}">
                                                        <Run Text="{Binding RealizedPnl, StringFormat=${}{0:N2}, Mode=OneWay}"/>
                                                    </TextBlock>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- ── DIARIO ── -->
                    <Border Background="{DynamicResource ThemeBg1B}"
                            CornerRadius="10" Padding="18,14"
                            Margin="0,0,0,14">
                        <StackPanel>
                            <TextBlock Text="DIARIO" Style="{StaticResource SecTitle}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="NOTAS" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding Notes, TargetNullValue=--}"
                                               TextWrapping="Wrap" Opacity="0.85" Margin="0,2,0,12"/>
                                    <TextBlock Text="ERRORES" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding MistakeNotes, TargetNullValue=--}"
                                               TextWrapping="Wrap" Margin="0,2,0,12"
                                               Foreground="{DynamicResource ThemeLossTextB}" Opacity="0.9"/>
                                    <TextBlock Text="LECCIÓN" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding LessonLearned, TargetNullValue=--}"
                                               TextWrapping="Wrap" Margin="0,2,0,0"
                                               Foreground="{DynamicResource ThemeWinTextB}" Opacity="0.9"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="OBSERVACIÓN POST-TRADE" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding PostTradeObservation, TargetNullValue=--}"
                                               TextWrapping="Wrap" Opacity="0.85" Margin="0,2,0,12"/>
                                    <TextBlock Text="COMPROMISO DE MEJORA" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding ImprovementCommitment, TargetNullValue=--}"
                                               TextWrapping="Wrap" Margin="0,2,0,12"
                                               Foreground="{DynamicResource ThemeAmberB}" Opacity="0.9"/>
                                    <TextBlock Text="ETIQUETAS" Style="{StaticResource SecLbl}"/>
                                    <TextBlock Text="{Binding Tags, TargetNullValue=--}"
                                               TextWrapping="Wrap" FontSize="11" Margin="0,2,0,0"
                                               Foreground="{DynamicResource ThemeCyanB}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- ── CAPTURA DE PANTALLA ── -->
                    <Border Background="{DynamicResource ThemeBg1B}"
                            CornerRadius="10" Padding="18,14"
                            Visibility="{Binding ScreenshotPath, Converter={StaticResource NullVis}}">
                        <StackPanel>
                            <Grid Margin="0,0,0,10">
                                <TextBlock Text="CAPTURA DE PANTALLA" Style="{StaticResource SecTitle}" Margin="0"/>
                                <Button HorizontalAlignment="Right" VerticalAlignment="Center"
                                        Click="OpenScreenshot_Click" Cursor="Hand">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="Bd" Background="Transparent"
                                                    CornerRadius="4" Padding="8,3">
                                                <TextBlock Text="&#x1F517; Abrir en navegador"
                                                           FontSize="10"
                                                           Foreground="{DynamicResource ThemeCyanB}"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Bd" Property="Background" Value="#22FFFFFF"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </Grid>
                            <Border CornerRadius="8" Background="{DynamicResource ThemeBg0B}"
                                    Padding="4" BorderBrush="{DynamicResource ThemeStrokeB}"
                                    BorderThickness="1">
                                <Image Source="{Binding ScreenshotPath, Converter={StaticResource UrlImg}}"
                                       MaxHeight="420"
                                       Stretch="Uniform"
                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Border>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Border>
</Window>
